{"ast":null,"code":"import _classCallCheck from \"/home/nagiatzi/Desktop/MyReads/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/nagiatzi/Desktop/MyReads/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/home/nagiatzi/Desktop/MyReads/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/nagiatzi/Desktop/MyReads/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/home/nagiatzi/Desktop/MyReads/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/home/nagiatzi/Desktop/MyReads/src/BookSearch.js\";\nimport React, { Component } from 'react';\nimport { Link } from 'react-router-dom';\nimport PropTypes from 'prop-types';\nimport * as BooksAPI from './BooksAPI';\nimport Singlebook from './Singlebook';\n\nvar BookSearch =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(BookSearch, _Component);\n\n  function BookSearch() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, BookSearch);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(BookSearch)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.state = {\n      query: '',\n      searchBooks: [],\n      isSearching: false\n    };\n\n    _this.updateQuery = function (e) {\n      _this.setState({\n        query: e.target.value\n      }, function () {\n        _this.searchBooks(e);\n      });\n    };\n\n    _this.searchBooks = function (e) {\n      if (_this.state.query) {\n        _this.setState({\n          isSearching: true\n        });\n\n        BooksAPI.search(_this.state.query).then(function (res) {\n          if (res.error) {\n            _this.setState({\n              searchBooks: []\n            });\n          } else if (res) {\n            _this.updateBooks(res);\n          }\n        });\n      } else {\n        _this.setState({\n          searchBooks: []\n        });\n      }\n    };\n\n    _this.updateBooks = function (books) {\n      var searchedBooks = books;\n      var _iteratorNormalCompletion = true;\n      var _didIteratorError = false;\n      var _iteratorError = undefined;\n\n      try {\n        for (var _iterator = searchedBooks[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n          var book = _step.value;\n          book.shelf = 'none';\n          var _iteratorNormalCompletion2 = true;\n          var _didIteratorError2 = false;\n          var _iteratorError2 = undefined;\n\n          try {\n            for (var _iterator2 = _this.props.shelvedBooks[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {\n              var shelvedBook = _step2.value;\n              if (book.id === shelvedBook.id) book.shelf = shelvedBook.shelf;\n            }\n          } catch (err) {\n            _didIteratorError2 = true;\n            _iteratorError2 = err;\n          } finally {\n            try {\n              if (!_iteratorNormalCompletion2 && _iterator2.return != null) {\n                _iterator2.return();\n              }\n            } finally {\n              if (_didIteratorError2) {\n                throw _iteratorError2;\n              }\n            }\n          }\n        }\n      } catch (err) {\n        _didIteratorError = true;\n        _iteratorError = err;\n      } finally {\n        try {\n          if (!_iteratorNormalCompletion && _iterator.return != null) {\n            _iterator.return();\n          }\n        } finally {\n          if (_didIteratorError) {\n            throw _iteratorError;\n          }\n        }\n      }\n\n      _this.setState({\n        searchBooks: searchedBooks,\n        isSearching: false\n      });\n    };\n\n    _this.updateBook = function (books) {\n      var searchBooks = _this.state.searchBooks;\n      var _iteratorNormalCompletion3 = true;\n      var _didIteratorError3 = false;\n      var _iteratorError3 = undefined;\n\n      try {\n        for (var _iterator3 = searchBooks[Symbol.iterator](), _step3; !(_iteratorNormalCompletion3 = (_step3 = _iterator3.next()).done); _iteratorNormalCompletion3 = true) {\n          var book = _step3.value;\n          var _iteratorNormalCompletion4 = true;\n          var _didIteratorError4 = false;\n          var _iteratorError4 = undefined;\n\n          try {\n            for (var _iterator4 = books[Symbol.iterator](), _step4; !(_iteratorNormalCompletion4 = (_step4 = _iterator4.next()).done); _iteratorNormalCompletion4 = true) {\n              var shelvedBook = _step4.value;\n              if (book.id === shelvedBook.id) book.shelf = shelvedBook.shelf;\n            }\n          } catch (err) {\n            _didIteratorError4 = true;\n            _iteratorError4 = err;\n          } finally {\n            try {\n              if (!_iteratorNormalCompletion4 && _iterator4.return != null) {\n                _iterator4.return();\n              }\n            } finally {\n              if (_didIteratorError4) {\n                throw _iteratorError4;\n              }\n            }\n          }\n        }\n      } catch (err) {\n        _didIteratorError3 = true;\n        _iteratorError3 = err;\n      } finally {\n        try {\n          if (!_iteratorNormalCompletion3 && _iterator3.return != null) {\n            _iterator3.return();\n          }\n        } finally {\n          if (_didIteratorError3) {\n            throw _iteratorError3;\n          }\n        }\n      }\n\n      _this.setState({\n        searchBooks: searchBooks\n      });\n    };\n\n    _this.changeShelf = function (book, e) {\n      _this.props.onChangeShelf(book, e).then(function (books) {\n        return _this.updateBook(books);\n      });\n    };\n\n    return _this;\n  }\n\n  _createClass(BookSearch, [{\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var searchBooks = this.state.searchBooks;\n      return React.createElement(\"div\", {\n        className: \"search-books\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 69\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"search-books-bar\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 70\n        },\n        __self: this\n      }, React.createElement(Link, {\n        to: \"/\",\n        className: \"close-search\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 71\n        },\n        __self: this\n      }, \"Close\"), React.createElement(\"div\", {\n        className: \"search-books-input-wrapper\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 74\n        },\n        __self: this\n      }, React.createElement(\"input\", {\n        type: \"text\",\n        value: this.state.query,\n        placeholder: \"Search by title or author\",\n        onChange: function onChange(e) {\n          return _this2.updateQuery(e);\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 75\n        },\n        __self: this\n      }))), this.state.isSearching ? React.createElement(\"div\", {\n        className: \"loader\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 84\n        },\n        __self: this\n      }) : React.createElement(\"div\", {\n        className: \"search-books-results\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 86\n        },\n        __self: this\n      }, React.createElement(\"ol\", {\n        className: \"books-grid\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 87\n        },\n        __self: this\n      }, searchBooks.map(function (book) {\n        return React.createElement(Singlebook, {\n          key: book.id,\n          book: book,\n          onChangeShelf: _this2.changeShelf,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 89\n          },\n          __self: this\n        });\n      }))));\n    }\n  }]);\n\n  return BookSearch;\n}(Component);\n\nBookSearch.propTypes = {\n  shelvedBooks: PropTypes.array.isRequired,\n  onChangeShelf: PropTypes.func.isRequired\n};\nexport default BookSearch;","map":{"version":3,"sources":["/home/nagiatzi/Desktop/MyReads/src/BookSearch.js"],"names":["React","Component","Link","PropTypes","BooksAPI","Singlebook","BookSearch","state","query","searchBooks","isSearching","updateQuery","e","setState","target","value","search","then","res","error","updateBooks","books","searchedBooks","book","shelf","props","shelvedBooks","shelvedBook","id","updateBook","changeShelf","onChangeShelf","map","propTypes","array","isRequired","func"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport { Link } from 'react-router-dom';\nimport PropTypes from 'prop-types';\nimport * as BooksAPI from './BooksAPI';\nimport Singlebook from './Singlebook';\n\nclass BookSearch extends Component {\n\tstate = {\n\t\tquery: '',\n\t\tsearchBooks: [],\n\t\tisSearching: false\n\t};\n\n\tupdateQuery = e => {\n\t\tthis.setState({ query: e.target.value }, () => {\n\t\t\tthis.searchBooks(e);\n\t\t});\n\t};\n\n\tsearchBooks = e => {\n\t\tif (this.state.query) {\n\t\t\tthis.setState({ isSearching: true });\n\t\t\tBooksAPI.search(this.state.query).then(res => {\n\t\t\t\tif (res.error) {\n\t\t\t\t\tthis.setState({ searchBooks: [] });\n\t\t\t\t} else if (res) {\n\t\t\t\t\tthis.updateBooks(res);\n\t\t\t\t}\n\t\t\t});\n\t\t} else {\n\t\t\tthis.setState({ searchBooks: [] });\n\t\t}\n\t};\n\n\tupdateBooks = books => {\n\t\tconst searchedBooks = books;\n\t\tfor (const book of searchedBooks) {\n\t\t\tbook.shelf = 'none';\n\t\t\tfor (const shelvedBook of this.props.shelvedBooks) {\n\t\t\t\tif (book.id === shelvedBook.id) book.shelf = shelvedBook.shelf;\n\t\t\t}\n\t\t}\n\n\t\tthis.setState({\n\t\t\tsearchBooks: searchedBooks,\n\t\t\tisSearching: false\n\t\t});\n\t}; \n\n\tupdateBook = books => {\n\t\tconst {searchBooks} = this.state;\n\t\tfor (const book of searchBooks) {\n\t\t\tfor (const shelvedBook of books) {\n\t\t\t\tif (book.id === shelvedBook.id) book.shelf = shelvedBook.shelf;\n\t\t\t}\n\t\t}\n\n\t\tthis.setState({ searchBooks });\n\t};\n\n\tchangeShelf = (book, e) => {\n\t\tthis.props.onChangeShelf(book, e).then(books => this.updateBook(books));\n\t};\n\n\trender() {\n\t\tconst { searchBooks } = this.state;\n\n\t\treturn (\n\t\t\t<div className=\"search-books\">\n\t\t\t\t<div className=\"search-books-bar\">\n\t\t\t\t\t<Link to=\"/\" className=\"close-search\">\n\t\t\t\t\t\tClose\n\t\t\t\t\t</Link>\n\t\t\t\t\t<div className=\"search-books-input-wrapper\">\n\t\t\t\t\t\t<input\n\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\tvalue={this.state.query}\n\t\t\t\t\t\t\tplaceholder=\"Search by title or author\"\n\t\t\t\t\t\t\tonChange={e => this.updateQuery(e)}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t{this.state.isSearching ? (\n\t\t\t\t\t<div className=\"loader\" />\n\t\t\t\t) : (\n\t\t\t\t\t<div className=\"search-books-results\">\n\t\t\t\t\t\t<ol className=\"books-grid\">\n\t\t\t\t\t\t\t{searchBooks.map(book => (\n\t\t\t\t\t\t\t\t<Singlebook key={book.id} book={book} onChangeShelf={this.changeShelf} />\n\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t</ol>\n\t\t\t\t\t</div>\n\t\t\t\t)}\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nBookSearch.propTypes = {\n\tshelvedBooks: PropTypes.array.isRequired,\n\tonChangeShelf: PropTypes.func.isRequired\n};\n\nexport default BookSearch;\n"]},"metadata":{},"sourceType":"module"}